dist: xenial
language: python
python:
- '2.7'
- '3.4'
- '3.5'
- '3.6'
- '3.7'
- '3.8'
- '3.9'
install:
- make install
- make test-install
- pip install codecov
script:
- make test
- ". venv/bin/activate; coverage run test/__init__.py"
- ". venv/bin/activate; flake8 --statistics --count"
after_success:
- codecov
deploy:
  provider: pypi
  user: __token__
  password: "$PYPI_TOKEN"
  skip_cleanup: true
  distributions: sdist bdist_wheel
  on:
    branch: main
    condition: "$TRAVIS_TEST_RESULT = 0"
    tags: true
    python: '3.6'
notifications:
  slack:
    if: branch = main
    on_pull_requests: false
    on_success: never
    on_failure: change
    rooms:
      secure: btNfACha/8fuIMDdeUyMywSryI/XGm5ZE+cUEKo6l1Z6CX4VcnMCjNPGbj9GEL6jk0PDxBbdyEslci3dzt5ApOBMFg7OWTcPxDKoKNLHnUvEe2VPblZN0O1N/RAM3OPkhpbToo/uyZmnHIqTmOT51RfA1mkUYtu5YgPF+bwjhv0=
